---
title: "Regression Analysis"
author: "Embon,Barttfeld & Solovey"
date: "8/9/2021"
output: html_document
---

## Levantar datos
                                 
```{r levantar datos, echo=TRUE}

# voy a la carpeta del proyecto
root <- rprojroot::is_rstudio_project
basename(getwd())

# load the function to get the df list
source(root$find_file("Analysis/AuxiliaryFunctions/DataFrame_Filtered.R"))

# get the df list
# experimento = 1,2,ambos
DF_list <- DataFrame_Filtered(experimento = "todos", 
                                 filtroRT_Disc_Sup = 5000,
                                 filtroRT_Disc_Inf = 200,
                                 filtroRT_Conf_Sup = 5000,
                                 filtroRT_Conf_Inf = 0,
                                 filtroTrial = 20,
                                 cant_trial_filter = 90)

# DF_list:
# a df_total
# b d.sin.normalizar
# c d.sin.normalizar.mc.filter
# d d
# e d.mc.filter
# f d.sin.normalizar.solo.FyM
# g d.sin.normalizar.solo.FyM.mc.filter
# h d.solo.FyM.mc.filter

df_total <- DF_list$a
d.sin.normalizar.solo.FyM.mc.filter <- DF_list$g # 
###############
### library ###
###############
library(arm)
library(dplyr)

###########################
### Regression Analysis ###
###########################

### lineas para hacer regresion 

d.sin.normalizar.solo.FyM.mc.filter$aq.norm <- (d.sin.normalizar.solo.FyM.mc.filter$aq - mean(d.sin.normalizar.solo.FyM.mc.filter$aq))/
        sd(d.sin.normalizar.solo.FyM.mc.filter$aq)

d.sin.normalizar.solo.FyM.mc.filter$mc.norm <- (d.sin.normalizar.solo.FyM.mc.filter$mc 
                                                - mean(d.sin.normalizar.solo.FyM.mc.filter$mc))/ sd(d.sin.normalizar.solo.FyM.mc.filter$mc)

d.sin.normalizar.solo.FyM.mc.filter$edad.norm <- (d.sin.normalizar.solo.FyM.mc.filter$edad 
                                                - mean(d.sin.normalizar.solo.FyM.mc.filter$edad))/ sd(d.sin.normalizar.solo.FyM.mc.filter$edad)

d1 = d.sin.normalizar.solo.FyM.mc.filter
d1[d1 == "Masculino"] <- "1"
d1[d1 == "Femenino"] <- "0"
d1$Im <- as.integer(d1$Im)

# sujetos que tienen un 85 % de trials en una misma respuesta de confianza

source(root$find_file("Analysis/AuxiliaryFunctions/discard_by_x_same_confidence.R"))
sujetos_a_descartar <- discard_by_x_same_confidence(85)
d2 <- d1[! d1$sujetos %in% sujetos_a_descartar,]

```

##### Empiezo a correr modelos de regresiones

## Modelo 1
```{r modelo 1, echo=TRUE}

a=lm(mc ~ aq.norm +
       Im +
       edad.norm+
       es +
       aq.norm: Im,
     data = d2) 
summary(a)

```
## Modelo 2

```{r Modelo 2, echo=TRUE}

a=lm(mc ~ aq.norm +
       Im +
       aq.norm: Im,
     data = d2) 
summary(a)

```
## Modelo 3

```{r Modelo 3, echo=TRUE}

a=lm(mc ~ aq.norm +
       Im +
       edad.norm+
       aq.norm: Im+
       aq.norm:edad.norm+
       Im:edad.norm,
     data = d2) 
summary(a)

```

## Modelo 4

```{r Modelo 4, echo=TRUE}

a=lm(mc ~ aq.norm +
       Im +
       edad.norm+
       es +
       aq.norm: Im+
       aq.norm:edad.norm+
       Im:edad.norm+
       es:aq.norm,
     data = d2) 
summary(a)

```
## Modelo 5 

```{r Modelo 5, echo=TRUE}

a=lm(mc.norm ~ aq.norm +
       Im +
       edad.norm+
       aq.norm: Im,
       #aq.norm:edad.norm+
       #Im:edad.norm,
     data = d2) 
summary(a)

```
## Modelo 6 (este es el modelo final que usariamos)

```{r Modelo 6, echo=TRUE}

a=lm(mc ~ aq.norm +
       Im +
       edad.norm+
       aq.norm: Im+
       aq.norm:edad.norm,
       #Im:edad.norm,
     data = d2) 
summary(a)

```